<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edytuj Profil</title>
    <link rel="stylesheet" href="https://www.manticore.uni.lodz.pl/~druzb5/static/styles.css">
    <link rel="icon" href="faviconfolder/favicon.ico" type="image/x-icon"> 
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Retrieve the user information from localStorage
            var storedUserData = JSON.parse(localStorage.getItem('user_data')) || {};

            // Update the form with the stored user data
            if (storedUserData.username) {
                var usernameInput = document.getElementById('id_username');
                usernameInput.value = storedUserData.username;
            }
            if (storedUserData.first_name) {
                var firstNameInput = document.getElementById('id_first_name');
                firstNameInput.value = storedUserData.first_name;
            }
            if (storedUserData.last_name) {
                var lastNameInput = document.getElementById('id_last_name');
                lastNameInput.value = storedUserData.last_name;
            }
            if (storedUserData.email) {
                var emailInput = document.getElementById('id_email');
                emailInput.value = storedUserData.email;
            }
            if (storedUserData.phone) {
                var phoneInput = document.getElementById('id_phone');
                phoneInput.value = storedUserData.phone;
            }
            if (storedUserData.photo) {
                // Display the base64-encoded photo
                var photoImg = document.getElementById('id_photo_display');
               
            }
            if (storedUserData.bio) {
                var bioInput = document.getElementById('id_bio');
                bioInput.value = storedUserData.bio;
            }

            // Add event listener to the form submission
            var editForm = document.getElementById('edit-form');
            editForm.addEventListener('submit', function (event) {
                event.preventDefault(); // Prevent the form from submitting normally

                // Get values from the form
                var newUsername = document.getElementById('id_username').value;
                var newFirstName = document.getElementById('id_first_name').value;
                var newLastName = document.getElementById('id_last_name').value;
                var newEmail = document.getElementById('id_email').value;
                var newPhone = document.getElementById('id_phone').value;
                var newPhoto = document.getElementById('id_photo').value;
                var newBio = document.getElementById('id_bio').value;

             

                // Update user information in localStorage
                var updatedUserData = {
                    username: newUsername,
                    first_name: newFirstName,
                    last_name: newLastName,
                    email: newEmail,
                    phone: newPhone,
                    photo: newPhoto,
                    bio: newBio
                };

                localStorage.setItem('user_data', JSON.stringify(updatedUserData));

               
                window.location.href = '../pages/home.html';
            });
        });
    </script>
</head>
<body>
    <header>
        <nav>
            <ul>
                <li class="logout-link"><a href="../index.html">Wyloguj</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <div class="center-content-profile">
            <h1><center>Edytuj Profil</center></h1>
            <form id="edit-form" action="#" method="post">
                <fieldset>
                    <p>
                        <label for="id_username">Nazwa Użytkownika</label>
                        <input type="text" name="username" id="id_username" placeholder="Nazwa użytkownika" required="">
                    </p>
                    <p>
                        <label for="id_first_name">Imię</label>
                        <input type="text" name="first_name" id="id_first_name" placeholder="Imię">
                    </p>
                    <p>
                        <label for="id_last_name">Nazwisko</label>
                        <input type="text" name="last_name" id="id_last_name" placeholder="Nazwisko">
                    </p>
                    <p>
                        <label for="id_email">Email</label>
                        <input type="email" name="email" id="id_email" placeholder="Email">
                    </p>
                    <p>
                        <label for="id_phone">Telefon</label>
                        <input type="tel" name="phone" id="id_phone" placeholder="Telefon">
                    </p>
                    <p>
                        <label for="id_photo">Zdjęcie</label>
                        <input type="file" name="photo" id="id_photo" accept="image/*">
                        
                        
                    </p>
                    <p>
                        <label for="id_bio">Krótka Notatka Bio</label>
                        <textarea name="bio" id="id_bio" placeholder="Krótka notatka bio"></textarea>
                    </p>
                    <p>
                        <input type="submit" value="Zapisz zmiany">
                        <a href="../pages/home.html">Anuluj</a>
                    </p>
                </fieldset>
            </form>
        </div>
    </main>
    <footer>
        &copy; 2023 K5 Studio
    </footer>
    <script src="../static/script.js"></script>
</body>
</html>
